<!-- Profile dropdown -->
<div class="relative group inline-block" #popupWrapper>
    <button aria-expanded="false" aria-haspopup="true" #profileButton (click)="togglePopup()"
        class="w-10 h-10 rounded-full overflow-hidden border border-gray-300" id="profile-button" type="button">
        <img alt="User profile picture of a person with light brown hair and beard" class="w-full h-full object-cover"
            height="40" width="40" [src]="avatarPath + currentUser.avatarUrl" />
    </button>
    <div *ngIf="popupOpen" #popup
        class=" absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg p-6 text-sm text-[#0f0f0f] z-10"
        style="font-family: 'Inter', sans-serif;">
        <div class="flex items-center gap-3 mb-4">
            <img alt="User profile picture of a person with light brown hair and beard" class="w-10 h-10 rounded-full"
                height="40" width="40" [src]="avatarPath + currentUser.avatarUrl" />
            <div>
                <p class="font-semibold">
                    {{ currentUser.userName }}
                </p>
                <a class="text-[#8a63e8] text-xs underline hover:no-underline" [routerLink]="['/library', userId]">
                    Library
                </a>
            </div>
        </div>
        <hr class="border-[#d9dee4] mb-4" />
        <button class="flex items-center gap-3 w-full mb-4 text-sm font-normal hover:bg-[#f4f7fa] rounded-md px-3 py-2"
            type="button">
            <i class="fas fa-cog text-lg">
            </i>
            <a [routerLink]="['/profile', userId]">
                Profile
            </a>
        </button>
        <button class="flex items-center gap-3 w-full mb-4 text-sm font-normal hover:bg-[#f4f7fa] rounded-md px-3 py-2"
            type="button">
            <i class="fas fa-moon text-lg">
            </i>
            Dark mode
            <div class="ml-auto">
                <label class="inline-flex relative items-center cursor-pointer" for="dark-mode-toggle">
                    <input class="sr-only peer" id="dark-mode-toggle" type="checkbox" value="" />
                    <div
                        class="w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-4 peer-focus:ring-[#8a63e8] peer-checked:bg-[#8a63e8] relative">
                    </div>
                    <div
                        class="absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform peer-checked:translate-x-5">
                    </div>
                </label>
            </div>
        </button>
        <button class="flex items-center gap-3 w-full mb-4 text-sm font-normal hover:bg-[#f4f7fa] rounded-md px-3 py-2"
            type="button">
            <i class="fas fa-ellipsis-h">
            </i>
            More
            <i class="fas fa-chevron-right ml-auto">
            </i>
        </button>
        <hr class="border-[#d9dee4] mb-4" />
        <button (click)="logout()"
            class="flex items-center gap-3 w-full text-sm font-normal hover:bg-[#f4f7fa] rounded-md px-3 py-2"
            type="button">
            <i class="fas fa-sign-out-alt">
            </i>
            Log out
        </button>
    </div>
</div>